<!DOCTYPE html>
<html lang="hi">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="theme-color" content="#000000" />
    <meta name="description" content="Pi Network Barter Application - Final Vanilla JS UI" />
    <title>Barter-Pi Pro - Final UI</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;800&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Inter', sans-serif; }
        /* ‡§Æ‡•Å‡§ñ‡•ç‡§Ø ‡§™‡•á‡§ú ‡§∏‡§æ‡§Æ‡§ó‡•ç‡§∞‡•Ä ‡§ï‡•á ‡§≤‡§ø‡§è CSS */
        .page-content { display: none; }
        .page-content.active { display: block; }
        /* Scrollbar fix (aesthetic) */
        ::-webkit-scrollbar { width: 8px; }
        ::-webkit-scrollbar-thumb { background: #cbd5e1; border-radius: 10px; }
        ::-webkit-scrollbar-track { background: #f1f5f9; }
    </style>
</head>
<body class="bg-gray-50 min-h-screen">
    <div id="app">
        
        <header class="bg-white shadow-md sticky top-0 z-20">
            <div class="max-w-7xl mx-auto px-2 sm:px-4 lg:px-6 py-3 flex flex-wrap justify-between items-center">
                <h1 class="text-2xl font-extrabold text-indigo-600 w-full xs:w-auto">
                    Barter-<span class="text-yellow-500">Pi</span> Pro
                </h1>
                
                <div class="text-sm text-gray-600 text-right mt-1 w-auto ml-auto flex items-center space-x-2">
                    <select class="bg-gray-100 p-1 rounded text-xs">
                        <option>üåê Hindi</option>
                        <option>üåê English</option>
                    </select>
                    <span class="font-mono text-xs bg-gray-100 p-1 rounded whitespace-nowrap">
                        ADM_PRO_USER_007 <span role="img" aria-label="Verified">‚úÖ</span>
                    </span>
                </div>
                
                <div class="flex flex-wrap justify-center sm:justify-start w-full mt-2 -mb-1" id="nav-buttons">
                    </div>
            </div>
        </header>

        <main class="pb-10 max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
            <section id="Home" class="page-content active space-y-8">
                <div class="bg-indigo-600 p-6 rounded-xl shadow-xl text-white flex justify-between items-center">
                    <div>
                        <p class="text-lg font-semibold mb-1">Pi Wallet Balance (Mainnet)</p>
                        <h2 class="text-5xl font-extrabold">12,456.78 <span class="text-yellow-400">Pi</span></h2>
                        <p class="text-sm opacity-80 mt-1">**~$2,990.00 USD** | <span class="text-red-300">Pi Price Tracker</span></p>
                    </div>
                    <button class="bg-yellow-500 text-gray-900 font-bold py-3 px-6 rounded-lg shadow-lg hover:bg-yellow-400 transition" onclick="alert('Pi Wallet Authentication Initiated')">
                        <span role="img" aria-label="Wallet">üëõ</span> Pi Wallet ‡§ñ‡•ã‡§≤‡•á‡§Ç
                    </button>
                </div>

                <div class="bg-white p-6 rounded-xl shadow-lg border border-indigo-100 space-y-4">
                    <h2 class="text-xl font-bold text-gray-800">‡§≤‡•ã‡§ï‡§≤ / ‡§ó‡•ç‡§≤‡•ã‡§¨‡§≤ ‡§¨‡§æ‡§∞‡•ç‡§ü‡§∞ ‡§ñ‡•ã‡§ú‡•á‡§Ç</h2>
                    <div class="flex flex-col sm:flex-row space-y-3 sm:space-y-0 sm:space-x-3 mb-4">
                        <input type="text" placeholder="‡§Ü‡§á‡§ü‡§Æ ‡§Ø‡§æ ‡§ï‡•Ä‡§µ‡§∞‡•ç‡§° ‡§ñ‡•ã‡§ú‡•á‡§Ç..." class="flex-grow p-3 border border-gray-300 rounded-lg focus:ring-indigo-500 focus:border-indigo-500" />
                        <select id="scope-filter" class="p-3 border border-gray-300 rounded-lg">
                            <option value="Global">‡§ó‡•ç‡§≤‡•ã‡§¨‡§≤</option>
                            <option value="Local">‡§≤‡•ã‡§ï‡§≤ (50km)</option>
                        </select>
                        <button class="bg-indigo-600 text-white p-3 rounded-lg font-semibold hover:bg-indigo-700 transition">Search</button>
                    </div>
                    <div class="h-40 bg-gray-200 rounded-lg flex items-center justify-center text-gray-500">
                        [Local Listing Map Placeholder]
                    </div>
                </div>
                
                <div class="flex space-x-3 justify-between items-center p-4 bg-white rounded-xl shadow-lg">
                    <select id="category-filter" class="p-2 border rounded-lg">
                        <option value="">‡§∏‡§≠‡•Ä ‡§ï‡•à‡§ü‡•á‡§ó‡§∞‡•Ä</option>
                        <option value="Goods">Goods (‡§∏‡§æ‡§Æ‡§æ‡§®)</option>
                        <option value="Electronics">Electronics</option>
                        <option value="Services">Services</option>
                        <option value="NFT/Digital">NFT/Digital</option>
                    </select>
                    <select class="p-2 border rounded-lg">
                        <option>‡§∏‡•â‡§∞‡•ç‡§ü ‡§ï‡§∞‡•á‡§Ç: ‡§®‡§µ‡•Ä‡§®‡§§‡§Æ</option>
                        <option>‡§∏‡•â‡§∞‡•ç‡§ü ‡§ï‡§∞‡•á‡§Ç: ‡§∏‡§¨‡§∏‡•á ‡§∏‡§∏‡•ç‡§§‡§æ Pi</option>
                    </select>
                     <button 
                        class="bg-green-600 hover:bg-green-700 text-white font-bold py-2 px-4 rounded-lg transition"
                        onclick="openModal('NewListing')"
                    >
                        + ‡§™‡•ã‡§∏‡•ç‡§ü ‡§ï‡§∞‡•á‡§Ç
                    </button>
                </div>

                <h2 class="text-2xl font-bold text-gray-800 mb-4 border-b pb-2">‡§≤‡•á‡§ü‡•á‡§∏‡•ç‡§ü ‡§¨‡§æ‡§∞‡•ç‡§ü‡§∞ ‡§≤‡§ø‡§∏‡•ç‡§ü‡§ø‡§Ç‡§ó‡•ç‡§∏</h2>
                <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6" id="listings-grid">
                    </div>
            </section>

            <section id="Profile" class="page-content space-y-8">
                <div class="bg-white p-8 rounded-xl shadow-xl">
                    <h2 class="text-3xl font-bold text-indigo-600 mb-6">üë§ ‡§Æ‡•á‡§∞‡§æ Pi ‡§™‡•ç‡§∞‡•ã‡§´‡§º‡§æ‡§á‡§≤</h2>
                    <div id="login-section">
                        <div class="text-center space-y-4">
                            <p class="text-lg text-gray-600">Pi Network SDK ‡§ï‡•á ‡§Æ‡§æ‡§ß‡•ç‡§Ø‡§Æ ‡§∏‡•á ‡§≤‡•â‡§ó ‡§á‡§® ‡§ï‡§∞‡•á‡§Ç</p>
                            <button class="bg-yellow-500 text-gray-900 font-bold py-3 px-8 rounded-lg shadow-lg hover:bg-yellow-400 transition text-xl" onclick="loginUser()">
                                <span role="img" aria-label="Pi">‚õèÔ∏è</span> Pi Login
                            </button>
                        </div>
                    </div>
                    <div id="dashboard-section" style="display: none;">
                         <div class="space-y-6">
                            <div class="flex items-center space-x-4 border-b pb-4">
                                <div class="w-16 h-16 bg-indigo-100 rounded-full flex items-center justify-center text-3xl font-bold text-indigo-600">P</div>
                                <div>
                                    <p class="text-2xl font-bold">ADM_PRO_USER_007 <span class="text-green-500 text-xl">‚úÖ KYC Verified</span></p>
                                    <p class="text-sm text-gray-600 font-mono break-all">Pi Wallet Public Key: G6Q7...X0F8</p>
                                    <div class="mt-1 flex space-x-2">
                                        <span class="bg-green-100 text-green-700 text-xs px-2 py-1 rounded-full font-medium">Verified Pioneer</span>
                                    </div>
                                </div>
                            </div>
                            <h3 class="text-2xl font-bold text-gray-800 border-b pb-2">üìä ‡§∏‡•á‡§≤‡§∞ ‡§è‡§®‡§æ‡§≤‡§ø‡§ü‡§ø‡§ï‡•ç‡§∏</h3>
                            <div class="grid grid-cols-2 gap-4">
                                <div class="bg-green-50 p-4 rounded-lg shadow-sm">
                                    <p class="text-xl font-extrabold text-green-600">32,500 Pi</p>
                                    <p class="text-sm text-gray-600">‡§ï‡•Å‡§≤ ‡§Ö‡§∞‡•ç‡§ú‡§ø‡§§ (All Time)</p>
                                </div>
                                <div class="bg-blue-50 p-4 rounded-lg shadow-sm">
                                    <p class="text-xl font-extrabold text-blue-600">4.8/5 ‚≠ê</p>
                                    <p class="text-sm text-gray-600">‡§î‡§∏‡§§ ‡§µ‡§ø‡§ï‡•ç‡§∞‡•á‡§§‡§æ ‡§∞‡•á‡§ü‡§ø‡§Ç‡§ó</p>
                                </div>
                            </div>
                            <button class="w-full bg-indigo-500 text-white py-3 rounded-lg font-bold hover:bg-indigo-600" onclick="alert('Generating Annual Tax Report...')">
                                <span role="img" aria-label="Report">üìë</span> ‡§µ‡§æ‡§∞‡•ç‡§∑‡§ø‡§ï ‡§ü‡•ç‡§∞‡•á‡§° ‡§∞‡§ø‡§™‡•ã‡§∞‡•ç‡§ü (CSV)
                            </button>
                        </div>
                    </div>
                </div>
            </section>

            <section id="Orders" class="page-content space-y-8">
                <h2 class="text-3xl font-bold text-indigo-600 border-b pb-3">Order ‡§î‡§∞ ‡§ü‡•ç‡§∞‡•à‡§ï‡§ø‡§Ç‡§ó (Escrow Supported)</h2>
                <div id="orders-list">
                    </div>
            </section>

            <section id="Chat" class="page-content">
                <div class="p-4 sm:p-8 bg-white rounded-xl shadow-lg h-[700px] flex border border-gray-200">
                    <div class="flex flex-col w-full md:w-1/3 border-r pr-4 space-y-2 overflow-y-auto">
                        <h3 class="font-bold text-lg mb-2 text-indigo-600">‡§Æ‡•á‡§∞‡•Ä ‡§ö‡•à‡§ü‡•ç‡§∏</h3>
                        <div class="px-3 py-3 bg-indigo-100 text-indigo-700 rounded-xl font-semibold border-l-4 border-indigo-600 cursor-pointer">
                            üí¨ **iPhone 14 Pro** (Buyer)
                        </div>
                        <div class="px-3 py-3 bg-yellow-100 text-yellow-700 rounded-xl hover:bg-yellow-200 cursor-pointer">
                            ü§ñ **AI Helper Chat**
                        </div>
                    </div>
                    <div class="flex flex-col w-full md:w-2/3 md:pl-4">
                        <h2 class="text-xl font-bold text-gray-800 mb-4 border-b pb-2">iPhone 14 Pro (Chat Window)</h2>
                         <div class="flex-grow bg-gray-50 p-4 rounded-lg overflow-y-scroll space-y-4">
                            <div class="flex justify-start">
                                <div class="bg-white p-3 rounded-xl rounded-tl-none max-w-xs shadow-md">‡§®‡§Æ‡§∏‡•ç‡§§‡•á, ‡§ï‡•ç‡§Ø‡§æ 400 Pi ‡§†‡•Ä‡§ï ‡§∞‡§π‡•á‡§ó‡§æ?</div>
                            </div>
                            <div class="flex justify-end">
                                <div class="text-right">
                                    <div class="bg-indigo-100 p-3 rounded-xl rounded-tr-none max-w-xs shadow-md">450 Pi ‡§Ö‡§Ç‡§§‡§ø‡§Æ ‡§Æ‡•Ç‡§≤‡•ç‡§Ø ‡§π‡•à‡•§</div>
                                </div>
                            </div>
                        </div>
                        <div class="mt-4 flex space-x-2">
                            <input type="text" placeholder="‡§Æ‡•à‡§∏‡•á‡§ú ‡§≤‡§ø‡§ñ‡•á‡§Ç..." class="flex-grow p-3 border border-gray-300 rounded-lg focus:ring-indigo-500 focus:border-indigo-500" />
                            <button class="bg-indigo-600 text-white p-3 rounded-lg font-semibold hover:bg-indigo-700 transition">Send</button>
                        </div>
                    </div>
                </div>
            </section>

            <section id="AIHelper" class="page-content">
                <div class="max-w-4xl mx-auto">
                    <div class="p-6 bg-white rounded-xl shadow-lg h-[650px] flex flex-col border border-indigo-200">
                        <h2 class="text-2xl font-bold text-indigo-600 mb-4 border-b pb-2">ü§ñ AI ‡§π‡•á‡§≤‡•ç‡§™‡§∞ (Gemini Pro)</h2>
                        <div class="flex-grow bg-gray-50 p-4 rounded-lg overflow-y-scroll space-y-4 mb-4" id="ai-messages">
                            <div class="flex justify-start">
                                <div class="max-w-lg p-3 rounded-xl shadow-md bg-gray-200 text-gray-800 rounded-tl-none">
                                    ‡§®‡§Æ‡§∏‡•ç‡§§‡•á! ‡§Æ‡•à‡§Ç Barter-Pi Pro ‡§ï‡§æ **Gemini AI** ‡§Ö‡§∏‡§ø‡§∏‡•ç‡§ü‡•á‡§Ç‡§ü ‡§π‡•Ç‡§Å‡•§ ‡§Æ‡•à‡§Ç ‡§≤‡§ø‡§∏‡•ç‡§ü‡§ø‡§Ç‡§ó ‡§¨‡§®‡§æ‡§®‡•á, Pi ‡§Æ‡•Ç‡§≤‡•ç‡§Ø ‡§®‡§ø‡§∞‡•ç‡§ß‡§æ‡§∞‡§£ ‡§Ø‡§æ ‡§ü‡•ç‡§∞‡•á‡§°‡§ø‡§Ç‡§ó ‡§ï‡•á ‡§®‡§ø‡§Ø‡§Æ‡•ã‡§Ç ‡§Æ‡•á‡§Ç ‡§Ü‡§™‡§ï‡•Ä ‡§Æ‡§¶‡§¶ ‡§ï‡§∞ ‡§∏‡§ï‡§§‡§æ ‡§π‡•Ç‡§Å‡•§
                                </div>
                            </div>
                        </div>
                        <form class="flex space-x-2" id="ai-form">
                            <input type="text" placeholder="Gemini ‡§∏‡•á ‡§™‡•ç‡§∞‡§∂‡•ç‡§® ‡§™‡•Ç‡§õ‡•á‡§Ç..." class="flex-grow p-3 border border-gray-300 rounded-lg focus:ring-indigo-500 focus:border-indigo-500" id="ai-input"/>
                            <button type="submit" class="bg-indigo-600 text-white p-3 rounded-lg font-semibold hover:bg-indigo-700 transition">Send <span role="img" aria-label="Rocket">üöÄ</span></button>
                        </form>
                    </div>
                </div>
            </section>

            <section id="Admin" class="page-content">
                <h2 class="text-3xl font-bold text-red-600 border-b pb-3">üö® ‡§è‡§°‡§Æ‡§ø‡§® ‡§°‡•à‡§∂‡§¨‡•ã‡§∞‡•ç‡§° (PRO Access)</h2>
                <div class="mt-8 bg-white p-6 rounded-xl shadow-lg border-l-4 border-red-600">
                    <h3 class="text-xl font-semibold text-gray-800 mb-4">‡§µ‡§ø‡§µ‡§æ‡§¶ ‡§∏‡§Æ‡§æ‡§ß‡§æ‡§® (Dummy)</h3>
                    <p class="text-sm text-gray-500">‡§Ø‡§π‡§æ‡§Ç ‡§≤‡§Ç‡§¨‡§ø‡§§ ‡§µ‡§ø‡§µ‡§æ‡§¶‡•ã‡§Ç ‡§ï‡•ã ‡§Æ‡•â‡§°‡§∞‡•á‡§ü‡§∞ ‡§¶‡•ç‡§µ‡§æ‡§∞‡§æ ‡§π‡§≤ ‡§ï‡§ø‡§Ø‡§æ ‡§ú‡§æ‡§è‡§ó‡§æ‡•§</p>
                </div>
            </section>
        </main>
        
        <footer class="bg-white border-t p-4 text-center text-sm text-gray-500">
            Barter-Pi Pro | üîí Pi Escrow ‡§∏‡§Æ‡§∞‡•ç‡§•‡§ø‡§§ | Gemini AI ‡§¶‡•ç‡§µ‡§æ‡§∞‡§æ ‡§∏‡§Ç‡§ö‡§æ‡§≤‡§ø‡§§ (Vanilla JS)
        </footer>

        <div id="modal-container">
            <div id="NewListing-modal" class="fixed inset-0 bg-black bg-opacity-50 z-50 justify-center items-start pt-10 p-4 hidden">
                <div class="bg-white rounded-xl shadow-2xl w-full max-w-lg overflow-y-auto max-h-[90vh]">
                    <div class="p-6 border-b flex justify-between items-center sticky top-0 bg-white z-10">
                        <h2 class="text-2xl font-bold text-gray-800">‡§®‡§Ø‡§æ ‡§¨‡§æ‡§∞‡•ç‡§ü‡§∞ ‡§™‡•ã‡§∏‡•ç‡§ü ‡§ï‡§∞‡•á‡§Ç</h2>
                        <button onclick="closeModal('NewListing')" class="text-gray-400 hover:text-gray-600 text-3xl font-light">&times;</button>
                    </div>
                    <form onsubmit="alert('‡§≤‡§ø‡§∏‡•ç‡§ü‡§ø‡§Ç‡§ó ‡§°‡•ç‡§∞‡§æ‡§´‡•ç‡§ü ‡§∏‡•á‡§µ ‡§π‡•ã ‡§ó‡§Ø‡§æ!'); closeModal('NewListing'); return false;" class="p-6 space-y-4">
                        <input type="text" required placeholder="‡§Ü‡§á‡§ü‡§Æ ‡§ï‡§æ ‡§®‡§æ‡§Æ" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-indigo-500 focus:border-indigo-500" />
                        <textarea required placeholder="‡§Ü‡§á‡§ü‡§Æ ‡§ï‡§æ ‡§µ‡§ø‡§∏‡•ç‡§§‡•É‡§§ ‡§µ‡§ø‡§µ‡§∞‡§£..." rows="4" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-indigo-500 focus:border-indigo-500"></textarea>
                        
                        <button type="button" class="w-full bg-yellow-100 text-yellow-700 font-semibold py-2 rounded-lg hover:bg-yellow-200 transition" onclick="alert('AI Price Estimation: 150 Pi')">
                            <span role="img" aria-label="AI">üí°</span> AI ‡§∏‡•á **‡§Ö‡§®‡•Å‡§∂‡§Ç‡§∏‡§ø‡§§ Pi ‡§Æ‡•Ç‡§≤‡•ç‡§Ø** ‡§™‡•ç‡§∞‡§æ‡§™‡•ç‡§§ ‡§ï‡§∞‡•á‡§Ç
                        </button>

                        <input type="number" required placeholder="Pi ‡§Æ‡•á‡§Ç ‡§ï‡•Ä‡§Æ‡§§" step="0.01" min="0.01" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-indigo-500 focus:border-indigo-500" />
                        <select required class="w-full p-3 border border-gray-300 rounded-lg">
                            <option value="">--- ‡§ï‡•à‡§ü‡•á‡§ó‡§∞‡•Ä ‡§ö‡•Å‡§®‡•á‡§Ç ---</option>
                            <option value="Goods">Goods (‡§∏‡§æ‡§Æ‡§æ‡§®)</option>
                            <option value="Electronics">Electronics</option>
                            <option value="Services">Services</option>
                            <option value="Vehicles">Vehicles</option>
                            <option value="NFT/Digital">NFT/Digital</option>
                        </select>

                        <div class="border border-dashed border-gray-400 p-4 rounded-lg text-center">
                            <label class="block text-sm font-medium text-gray-700 mb-1">‡§õ‡§µ‡§ø/‡§µ‡•Ä‡§°‡§ø‡§Ø‡•ã ‡§Ö‡§™‡§≤‡•ã‡§°</label>
                            <input type="file" multiple class="w-full text-sm text-gray-500 file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-indigo-50 file:text-indigo-700 hover:file:bg-indigo-100"/>
                        </div>
                        
                        <div class="flex justify-end pt-4 border-t">
                            <button type="submit" class="bg-green-600 text-white font-bold py-2 px-4 rounded-lg hover:bg-green-700 transition shadow-md">‡§≤‡§ø‡§∏‡•ç‡§ü‡§ø‡§Ç‡§ó ‡§™‡•ã‡§∏‡•ç‡§ü ‡§ï‡§∞‡•á‡§Ç</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>

    </div> <script>
        // --- DUMMY DATA (No const/let, only var for maximum compatibility) ---
        var DUMMY_USER_ID = "ADM_PRO_USER_007";
        var DUMMY_LISTINGS = [
            { id: 'l1', itemName: 'Apple iPhone 14 Pro', pricePi: 450, status: 'Active', category: 'Electronics' },
            { id: 'l2', itemName: '‡§™‡•Å‡§∞‡§æ‡§®‡§æ ‡§∏‡§æ‡§á‡§ï‡§ø‡§≤', pricePi: 5, status: 'Active', category: 'Goods' }, // Updated to Goods
            { id: 'l3', itemName: '‡§µ‡•á‡§¨‡§∏‡§æ‡§á‡§ü ‡§°‡§ø‡§ú‡§æ‡§á‡§® ‡§∏‡•á‡§µ‡§æ (NFT)', pricePi: 50, status: 'Pending', category: 'Services' },
            { id: 'l4', itemName: '‡§π‡§∏‡•ç‡§§‡§®‡§ø‡§∞‡•ç‡§Æ‡§ø‡§§ ‡§™‡•á‡§Ç‡§ü‡§ø‡§Ç‡§ó', pricePi: 20, status: 'Active', category: 'Goods' }, // New Goods item
        ];
        var DUMMY_ORDERS = [
            { id: 'o1', item: 'iPhone 14 Pro', price: 450, status: 'Shipped', escrow: 'Active', type: 'buy' },
            { id: 'o2', item: 'Laptop Repair', price: 35, status: 'Delivered', escrow: 'Released', type: 'sell' },
        ];

        // --- NAVIGATION LOGIC ---
        function setupNavigation() {
            var pages = {
                'Home': '‡§π‡•ã‡§Æ', 'Profile': '‡§™‡•ç‡§∞‡•ã‡§´‡§º‡§æ‡§á‡§≤', 'Orders': '‡§ë‡§∞‡•ç‡§°‡§∞‡•ç‡§∏', 
                'Chat': '‡§ö‡•à‡§ü', 'AIHelper': 'AI ‡§π‡•á‡§≤‡•ç‡§™‡§∞', 'Admin': '‡§è‡§°‡§Æ‡§ø‡§®'
            };
            var navContainer = document.getElementById('nav-buttons');
            var DUMMY_USER_ID = "ADM_PRO_USER_007";
            var ADMIN_ID = DUMMY_USER_ID; 

            // ‡§™‡•Å‡§∞‡§æ‡§®‡•Ä ‡§∏‡§æ‡§Æ‡§ó‡•ç‡§∞‡•Ä ‡§ï‡•ã ‡§ñ‡§æ‡§≤‡•Ä ‡§ï‡§∞‡•á‡§Ç (Clear old content)
            navContainer.innerHTML = ''; 

            for (var pageId in pages) {
                if (pageId === 'Admin' && DUMMY_USER_ID !== ADMIN_ID) continue;
                
                var button = document.createElement('button');
                button.innerHTML = pages[pageId];
                button.setAttribute('data-page', pageId);
                
                // **‡§Ø‡§π‡§æ‡§Ç ‡§π‡•à ‡§µ‡§π ‡§Æ‡§π‡§§‡•ç‡§µ‡§™‡•Ç‡§∞‡•ç‡§£ ‡§Ö‡§™‡§°‡•á‡§ü‡•á‡§° ‡§ï‡•ã‡§° ‡§≤‡§æ‡§á‡§® (Pi Browser Optimized):**
                // ‡§Ø‡§π ‡§∏‡•Å‡§®‡§ø‡§∂‡•ç‡§ö‡§ø‡§§ ‡§ï‡§∞‡§§‡§æ ‡§π‡•à ‡§ï‡§ø ‡§¨‡§ü‡§® ‡§õ‡•ã‡§ü‡•á ‡§î‡§∞ ‡§∏‡§ò‡§® ‡§π‡•ã‡§Ç‡•§
                button.className = 'nav-button px-2 py-1 rounded-lg text-xs font-medium m-0.5 transition duration-200 text-gray-600 hover:bg-gray-100 whitespace-nowrap';
                
                button.onclick = function() { switchPage(this.getAttribute('data-page')); };
                navContainer.appendChild(button);
            }

            switchPage('Home');
        }

        function switchPage(pageId) {
            var contents = document.getElementsByClassName('page-content');
            for (var i = 0; i < contents.length; i++) {
                contents[i].className = contents[i].className.replace(' active', '');
            }
            
            var targetPage = document.getElementById(pageId);
            if (targetPage) {
                targetPage.className += ' active';
            }

            // Update active state on buttons
            var buttons = document.getElementsByClassName('nav-button');
            for (var i = 0; i < buttons.length; i++) {
                var btn = buttons[i];
                btn.className = btn.className.replace(' bg-indigo-600 text-white shadow-lg', '');
                if (btn.getAttribute('data-page') === pageId) {
                    btn.className += ' bg-indigo-600 text-white shadow-lg';
                }
            }
            
            // Render content specific to the page
            if (pageId === 'Orders') { renderOrders(); }
            if (pageId === 'Home') { renderListings(); }
        }

        // --- MODAL LOGIC ---
        function openModal(modalId) {
            var modal = document.getElementById(modalId + '-modal');
            if (modal) {
                modal.style.display = 'flex';
            }
        }
        function closeModal(modalId) {
            var modal = document.getElementById(modalId + '-modal');
            if (modal) {
                modal.style.display = 'none';
            }
        }

        // --- LOGIN LOGIC ---
        function loginUser() {
            alert('Pi Network Login SDK call simulated. Logging in...');
            document.getElementById('login-section').style.display = 'none';
            document.getElementById('dashboard-section').style.display = 'block';
        }

        // --- LISTING RENDERING (VANILLA JS) ---
        function renderListings() {
            var grid = document.getElementById('listings-grid');
            var html = '';
            var filterCategory = document.getElementById('category-filter').value;
            var filteredListings = DUMMY_LISTINGS.filter(function(listing) {
                return !filterCategory || listing.category === filterCategory;
            });

            if (filteredListings.length === 0) {
                 grid.innerHTML = '<p class="col-span-4 text-center text-gray-500 py-10">‡§á‡§∏ ‡§´‡§º‡§ø‡§≤‡•ç‡§ü‡§∞ ‡§ï‡•á ‡§∏‡§æ‡§• ‡§ï‡•ã‡§à ‡§≤‡§ø‡§∏‡•ç‡§ü‡§ø‡§Ç‡§ó ‡§®‡§π‡•Ä‡§Ç ‡§Æ‡§ø‡§≤‡•Ä‡•§</p>';
                 return;
            }

            for (var i = 0; i < filteredListings.length; i++) {
                var listing = filteredListings[i];
                var statusClass = listing.status === 'Active' ? 'bg-green-100 text-green-700' : 'bg-yellow-100 text-yellow-700';
                
                var itemImageText = listing.itemName.replace(/ /g, '+');

                html += '<div class="bg-white rounded-xl shadow-lg overflow-hidden border border-gray-200 hover:shadow-2xl hover:cursor-pointer transition duration-300 transform hover:scale-[1.02]" onclick="alert(\'Viewing details for ' + listing.itemName + '\')">';
                html += '<img src="https://via.placeholder.com/400x300?text=' + itemImageText + '" alt="' + listing.itemName + '" class="w-full h-40 object-cover" />';
                html += '<div class="p-4">';
                html += '<h3 class="text-lg font-bold text-gray-800 mb-1 h-12 overflow-hidden">' + listing.itemName + '</h3>';
                html += '<div class="flex justify-between items-center mb-3">';
                html += '<div class="text-2xl font-extrabold text-indigo-600">' + listing.pricePi + ' Pi</div>';
                html += '<span class="px-3 py-1 text-xs font-medium rounded-full ' + statusClass + '">' + listing.status + '</span>';
                html += '</div>';
                html += '<button class="w-full bg-indigo-500 hover:bg-indigo-600 text-white font-bold py-2 rounded-lg text-sm transition">‚ÑπÔ∏è ‡§µ‡§ø‡§µ‡§∞‡§£ ‡§¶‡•á‡§ñ‡•á‡§Ç</button>';
                html += '</div></div>';
            }
            grid.innerHTML = html;
        }

        // --- ORDER RENDERING (VANILLA JS) ---
        function renderOrders() {
            var listContainer = document.getElementById('orders-list');
            var html = '<h3 class="text-xl font-semibold text-gray-800 mb-4 border-b pb-2">üì¶ ‡§Æ‡•á‡§∞‡•á ‡§∏‡§≠‡•Ä ‡§ë‡§∞‡•ç‡§°‡§∞‡•ç‡§∏</h3>';
            
            for (var i = 0; i < DUMMY_ORDERS.length; i++) {
                var order = DUMMY_ORDERS[i];
                var statusClass = order.status === 'Delivered' ? 'bg-green-500 text-white' : 'bg-yellow-500 text-gray-900';
                var escrowStatus = order.escrow === 'Active' ? 'üîí Escrow Active' : '‚úÖ Pi Released';
                
                html += '<div class="mb-4 p-4 border rounded-lg shadow-sm flex flex-col sm:flex-row justify-between items-start sm:items-center ' + (order.type === 'buy' ? 'bg-blue-50' : 'bg-green-50') + '">';
                html += '<div>';
                html += '<p class="font-semibold text-lg">' + order.item + ' <span class="text-xs font-medium text-gray-500">(' + (order.type === 'buy' ? '‡§ñ‡§∞‡•Ä‡§¶' : '‡§¨‡§ø‡§ï‡•ç‡§∞‡•Ä') + ')</span></p>';
                html += '<p class="text-sm text-gray-500">‡§ï‡•Ä‡§Æ‡§§: **' + order.price + ' Pi** | Escrow: ' + escrowStatus + '</p>';
                html += '</div>';
                html += '<div class="text-right mt-2 sm:mt-0">';
                html += '<span class="px-3 py-1 text-sm font-bold rounded-full block ' + statusClass + '">' + order.status + '</span>';
                if (order.status === 'Shipped' && order.type === 'buy') {
                    html += '<button onclick="alert(\'Delivery Confirmed!\')" class="mt-1 text-green-600 text-sm hover:underline block font-semibold">‚úÖ ‡§°‡§ø‡§≤‡•Ä‡§µ‡§∞‡•Ä ‡§ï‡•Ä ‡§™‡•Å‡§∑‡•ç‡§ü‡§ø ‡§ï‡§∞‡•á‡§Ç</button>';
                }
                html += '</div></div>';
            }
            listContainer.innerHTML = html;
        }
        
        // --- FILTER EVENT LISTENER ---
        window.addEventListener('load', function() {
            var categoryFilter = document.getElementById('category-filter');
            if (categoryFilter) {
                categoryFilter.addEventListener('change', renderListings);
            }
        });


        // --- INITIALIZATION ---
        window.onload = function() {
            setupNavigation();
            renderListings(); // Load listings on Home page
        };
    </script>

</body>
</html>